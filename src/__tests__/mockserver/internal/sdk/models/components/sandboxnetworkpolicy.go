// Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.

package components

import (
	"encoding/json"
	"fmt"
)

// Mode - The network policy mode. - 'allow-all': All traffic is allowed. - 'deny-all': All traffic is blocked. - 'custom': Traffic is controlled by explicit allow/deny rules.
type Mode string

const (
	ModeAllowAll Mode = "allow-all"
	ModeDenyAll  Mode = "deny-all"
	ModeCustom   Mode = "custom"
)

func (e Mode) ToPointer() *Mode {
	return &e
}
func (e *Mode) UnmarshalJSON(data []byte) error {
	var v string
	if err := json.Unmarshal(data, &v); err != nil {
		return err
	}
	switch v {
	case "allow-all":
		fallthrough
	case "deny-all":
		fallthrough
	case "custom":
		*e = Mode(v)
		return nil
	default:
		return fmt.Errorf("invalid value for Mode: %v", v)
	}
}

// SandboxNetworkPolicy - The network policy applied to this sandbox, if any.
type SandboxNetworkPolicy struct {
	// The network policy mode. - 'allow-all': All traffic is allowed. - 'deny-all': All traffic is blocked. - 'custom': Traffic is controlled by explicit allow/deny rules.
	Mode Mode `json:"mode"`
	// List of domain names the sandbox is allowed to connect to. Supports wildcard patterns (e.g., "*.vercel.com" matches all subdomains).
	AllowedDomains []string `json:"allowedDomains,omitempty"`
	// List of IP address ranges (in CIDR notation) the sandbox is allowed to connect to.
	AllowedCIDRs []string `json:"allowedCIDRs,omitempty"`
	// List of IP address ranges (in CIDR notation) the sandbox is blocked from connecting to. These rules take precedence over all allowed rules.
	DeniedCIDRs []string `json:"deniedCIDRs,omitempty"`
	// HTTP header injection rules for outgoing requests matching specific domains.
	InjectionRules []SandboxInjectionRule `json:"injectionRules,omitempty"`
}

func (o *SandboxNetworkPolicy) GetMode() Mode {
	if o == nil {
		return Mode("")
	}
	return o.Mode
}

func (o *SandboxNetworkPolicy) GetAllowedDomains() []string {
	if o == nil {
		return nil
	}
	return o.AllowedDomains
}

func (o *SandboxNetworkPolicy) GetAllowedCIDRs() []string {
	if o == nil {
		return nil
	}
	return o.AllowedCIDRs
}

func (o *SandboxNetworkPolicy) GetDeniedCIDRs() []string {
	if o == nil {
		return nil
	}
	return o.DeniedCIDRs
}

func (o *SandboxNetworkPolicy) GetInjectionRules() []SandboxInjectionRule {
	if o == nil {
		return nil
	}
	return o.InjectionRules
}
