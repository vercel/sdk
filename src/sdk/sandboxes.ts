/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import { sandboxesCreateDirectory } from "../funcs/sandboxesCreateDirectory.js";
import { sandboxesCreateSnapshot } from "../funcs/sandboxesCreateSnapshot.js";
import { sandboxesDeleteSnapshot } from "../funcs/sandboxesDeleteSnapshot.js";
import { sandboxesExtendSandboxTimeout } from "../funcs/sandboxesExtendSandboxTimeout.js";
import { sandboxesGetCommand } from "../funcs/sandboxesGetCommand.js";
import { sandboxesGetCommandLogs } from "../funcs/sandboxesGetCommandLogs.js";
import { sandboxesGetSandbox } from "../funcs/sandboxesGetSandbox.js";
import { sandboxesGetSnapshot } from "../funcs/sandboxesGetSnapshot.js";
import { sandboxesKillCommand } from "../funcs/sandboxesKillCommand.js";
import { sandboxesListCommands } from "../funcs/sandboxesListCommands.js";
import { sandboxesListSandboxes } from "../funcs/sandboxesListSandboxes.js";
import { sandboxesListSnapshots } from "../funcs/sandboxesListSnapshots.js";
import { sandboxesReadFile } from "../funcs/sandboxesReadFile.js";
import {
  RunCommandAcceptEnum,
  sandboxesRunCommand,
} from "../funcs/sandboxesRunCommand.js";
import { sandboxesStopSandbox } from "../funcs/sandboxesStopSandbox.js";
import { sandboxesUpdateNetworkPolicy } from "../funcs/sandboxesUpdateNetworkPolicy.js";
import { sandboxesWriteFiles } from "../funcs/sandboxesWriteFiles.js";
import { JsonLStream } from "../lib/jsonl.js";
import { ClientSDK, RequestOptions } from "../lib/sdks.js";
import {
  CreateDirectoryRequest,
  CreateDirectoryResponseBody,
} from "../models/createdirectoryop.js";
import {
  CreateSnapshotRequest,
  CreateSnapshotResponseBody,
} from "../models/createsnapshotop.js";
import {
  DeleteSnapshotRequest,
  DeleteSnapshotResponseBody,
} from "../models/deletesnapshotop.js";
import {
  ExtendSandboxTimeoutRequest,
  ExtendSandboxTimeoutResponseBody,
} from "../models/extendsandboxtimeoutop.js";
import {
  GetCommandLogsRequest,
  GetCommandLogsResponseBody,
} from "../models/getcommandlogsop.js";
import {
  GetCommandRequest,
  GetCommandResponseBody,
} from "../models/getcommandop.js";
import {
  GetSandboxRequest,
  GetSandboxResponseBody,
} from "../models/getsandboxop.js";
import {
  GetSnapshotRequest,
  GetSnapshotResponseBody,
} from "../models/getsnapshotop.js";
import {
  KillCommandRequest,
  KillCommandResponseBody,
} from "../models/killcommandop.js";
import {
  ListCommandsRequest,
  ListCommandsResponseBody,
} from "../models/listcommandsop.js";
import {
  ListSandboxesRequest,
  ListSandboxesResponseBody,
} from "../models/listsandboxesop.js";
import {
  ListSnapshotsRequest,
  ListSnapshotsResponseBody,
} from "../models/listsnapshotsop.js";
import { ReadFileRequest } from "../models/readfileop.js";
import {
  RunCommandRequest,
  RunCommandResponse,
} from "../models/runcommandop.js";
import {
  StopSandboxRequest,
  StopSandboxResponseBody,
} from "../models/stopsandboxop.js";
import {
  UpdateNetworkPolicyRequest,
  UpdateNetworkPolicyResponseBody,
} from "../models/updatenetworkpolicyop.js";
import {
  WriteFilesRequest,
  WriteFilesResponseBody,
} from "../models/writefilesop.js";
import { unwrapAsync } from "../types/fp.js";

export { RunCommandAcceptEnum } from "../funcs/sandboxesRunCommand.js";

export class Sandboxes extends ClientSDK {
  /**
   * List sandboxes
   *
   * @remarks
   * Retrieves a paginated list of sandboxes belonging to a specific project. Results can be filtered by creation time using the `since` and `until` parameters.
   */
  async listSandboxes(
    request: ListSandboxesRequest,
    options?: RequestOptions,
  ): Promise<ListSandboxesResponseBody> {
    return unwrapAsync(sandboxesListSandboxes(
      this,
      request,
      options,
    ));
  }

  /**
   * List snapshots
   *
   * @remarks
   * Retrieves a paginated list of snapshots for a specific project.
   */
  async listSnapshots(
    request: ListSnapshotsRequest,
    options?: RequestOptions,
  ): Promise<ListSnapshotsResponseBody> {
    return unwrapAsync(sandboxesListSnapshots(
      this,
      request,
      options,
    ));
  }

  /**
   * Get a sandbox
   *
   * @remarks
   * Retrieves detailed information about a specific sandbox, including its current status, resource configuration, and exposed routes.
   */
  async getSandbox(
    request: GetSandboxRequest,
    options?: RequestOptions,
  ): Promise<GetSandboxResponseBody> {
    return unwrapAsync(sandboxesGetSandbox(
      this,
      request,
      options,
    ));
  }

  /**
   * List commands
   *
   * @remarks
   * Retrieves a list of all commands that have been executed in a sandbox, including their current status, exit codes, and execution times.
   */
  async listCommands(
    request: ListCommandsRequest,
    options?: RequestOptions,
  ): Promise<ListCommandsResponseBody> {
    return unwrapAsync(sandboxesListCommands(
      this,
      request,
      options,
    ));
  }

  /**
   * Execute a command
   *
   * @remarks
   * Executes a shell command inside a running sandbox. The command runs asynchronously and returns immediately with a command ID that can be used to track its progress and retrieve its output. Optionally, use the `wait` parameter to stream the command status until completion.
   */
  async runCommand(
    request: RunCommandRequest,
    options?: RequestOptions & { acceptHeaderOverride?: RunCommandAcceptEnum },
  ): Promise<RunCommandResponse> {
    return unwrapAsync(sandboxesRunCommand(
      this,
      request,
      options,
    ));
  }

  /**
   * Kill a command
   *
   * @remarks
   * Sends a signal to terminate a running command in a sandbox. The signal can be used to gracefully stop (SIGTERM) or forcefully kill (SIGKILL) the process. The command must still be running for this operation to succeed.
   */
  async killCommand(
    request: KillCommandRequest,
    options?: RequestOptions,
  ): Promise<KillCommandResponseBody> {
    return unwrapAsync(sandboxesKillCommand(
      this,
      request,
      options,
    ));
  }

  /**
   * Stop a sandbox
   *
   * @remarks
   * Stops a running sandbox and releases its allocated resources. All running processes within the sandbox will be terminated. This action cannot be undone. A stopped sandbox cannot be restarted.
   */
  async stopSandbox(
    request: StopSandboxRequest,
    options?: RequestOptions,
  ): Promise<StopSandboxResponseBody> {
    return unwrapAsync(sandboxesStopSandbox(
      this,
      request,
      options,
    ));
  }

  /**
   * Extend sandbox timeout
   *
   * @remarks
   * Extends the maximum execution time of a running sandbox. The sandbox must be active and able to accept commands. The total timeout cannot exceed the maximum allowed limit for your account.
   */
  async extendSandboxTimeout(
    request: ExtendSandboxTimeoutRequest,
    options?: RequestOptions,
  ): Promise<ExtendSandboxTimeoutResponseBody> {
    return unwrapAsync(sandboxesExtendSandboxTimeout(
      this,
      request,
      options,
    ));
  }

  /**
   * Update network policy
   *
   * @remarks
   * Replaces the network access policy of a running sandbox. Use this to control which external hosts the sandbox can communicate with. This is a full replacement. Any previously configured network rules will be overwritten.
   */
  async updateNetworkPolicy(
    request: UpdateNetworkPolicyRequest,
    options?: RequestOptions,
  ): Promise<UpdateNetworkPolicyResponseBody> {
    return unwrapAsync(sandboxesUpdateNetworkPolicy(
      this,
      request,
      options,
    ));
  }

  /**
   * Get a command
   *
   * @remarks
   * Retrieves the current status and details of a command executed in a sandbox. Use the `wait` parameter to block until the command finishes execution.
   */
  async getCommand(
    request: GetCommandRequest,
    options?: RequestOptions,
  ): Promise<GetCommandResponseBody> {
    return unwrapAsync(sandboxesGetCommand(
      this,
      request,
      options,
    ));
  }

  /**
   * Stream command logs
   *
   * @remarks
   * Streams the output of a command in real-time using newline-delimited JSON (ND-JSON). Each entry includes the output data and stream type. Stream types include `stdout`, `stderr`, and `error` (for stream failures).
   */
  async getCommandLogs(
    request: GetCommandLogsRequest,
    options?: RequestOptions,
  ): Promise<JsonLStream<GetCommandLogsResponseBody>> {
    return unwrapAsync(sandboxesGetCommandLogs(
      this,
      request,
      options,
    ));
  }

  /**
   * Read a file
   *
   * @remarks
   * Downloads the contents of a file from a sandbox's filesystem. The file content is returned as a binary stream with appropriate Content-Disposition headers for file download.
   */
  async readFile(
    request: ReadFileRequest,
    options?: RequestOptions,
  ): Promise<ReadableStream<Uint8Array>> {
    return unwrapAsync(sandboxesReadFile(
      this,
      request,
      options,
    ));
  }

  /**
   * Create a directory
   *
   * @remarks
   * Creates a new directory in a sandbox's filesystem. By default, parent directories are created recursively if they don't exist (similar to `mkdir -p`).
   */
  async createDirectory(
    request: CreateDirectoryRequest,
    options?: RequestOptions,
  ): Promise<CreateDirectoryResponseBody> {
    return unwrapAsync(sandboxesCreateDirectory(
      this,
      request,
      options,
    ));
  }

  /**
   * Write files
   *
   * @remarks
   * Uploads and extracts files to a sandbox's filesystem. Files must be uploaded as a gzipped tarball (`.tar.gz`) with the `Content-Type` header set to `application/gzip`. The tarball contents are extracted to the sandbox's working directory, or to a custom directory specified via the `x-cwd` header.
   */
  async writeFiles(
    request: WriteFilesRequest,
    options?: RequestOptions,
  ): Promise<WriteFilesResponseBody> {
    return unwrapAsync(sandboxesWriteFiles(
      this,
      request,
      options,
    ));
  }

  /**
   * Get a snapshot
   *
   * @remarks
   * Retrieves detailed information about a specific snapshot, including its creation time, size, expiration date, and the source sandbox it was created from.
   */
  async getSnapshot(
    request: GetSnapshotRequest,
    options?: RequestOptions,
  ): Promise<GetSnapshotResponseBody> {
    return unwrapAsync(sandboxesGetSnapshot(
      this,
      request,
      options,
    ));
  }

  /**
   * Delete a snapshot
   *
   * @remarks
   * Permanently deletes a snapshot and frees its associated storage. This action cannot be undone. After deletion, the snapshot can no longer be used to create new sandboxes.
   */
  async deleteSnapshot(
    request: DeleteSnapshotRequest,
    options?: RequestOptions,
  ): Promise<DeleteSnapshotResponseBody> {
    return unwrapAsync(sandboxesDeleteSnapshot(
      this,
      request,
      options,
    ));
  }

  /**
   * Create a snapshot
   *
   * @remarks
   * Creates a point-in-time snapshot of a running sandbox's filesystem. Snapshots can be used to quickly restore a sandbox to a previous state or to create new sandboxes with pre-configured environments. The sandbox must be running and able to accept commands for a snapshot to be created. The sandbox will be terminated after the snapshot is created.
   */
  async createSnapshot(
    request: CreateSnapshotRequest,
    options?: RequestOptions,
  ): Promise<CreateSnapshotResponseBody> {
    return unwrapAsync(sandboxesCreateSnapshot(
      this,
      request,
      options,
    ));
  }
}
